# 浙江大学

### 本科实验报告

```
课程名称：B/S体系软件设计
姓名：章世超
院系:计算机学院
专  业:软件工程
学  号:3130101437
指导教师:胡晓俊
完成日期：2017年6月10日
```



## 1 总体结构

#### 1.1后端： 数据库表结构

```
本系统所用到的数据库包括用户表，新闻偏好表，军事、体育、科技、教育、经济新闻表，总共7张表，数据库表结构关系如下：
```

![结构图 (1)](/Users/achao_zju/Downloads/结构图 (1).png)

#### 1.2 前端：组件化（路由）

```
系统的模块通过angular.js的routeParams（路由）服务被封装成组件。
个人认为：如此做两个好处，一是提供了代码的可维护性，提高了开发效率，二是加载页面时，只需要加载相应功能的代码，提高了页面加载速度和响应速度。
```

```
每个组件都有相应的控制器，控制器内逻辑代码实现了angular.js的MVVM双向数据绑定，与jQuery相比，减少繁琐DOM操作和数据维护操作。
```

```
本系统的路由架构如下图：
```

![组件图](/Users/achao_zju/Downloads/组件图.png)

## 2 主要技术与部署方案

#### 2.1 主要技术

- HTML5，CSS3，JS

  ```
  HTML5,CSS3,JS作为前端的基础知识，是一个优秀的前端工程师必须掌握的。
  ```


- angular.js

  ```
  正如前文提到的，angular.js是我用到的主要前端技术。angular.js帮助我实现了双向数据绑定，避免了繁琐的DOM操作，其出色的路由控制帮助我实现了模块化编程。
  ```

- bootswatch [bootstrap3 cosmo主题]

  ```
  bootstrap一直是使用最为广泛的UI库。为了避免审美疲劳，我采用了cosmo主题。
  bootstrap也为我提供了许多方便使用的组件，比如导航栏，模态框等。
  ```

- Sass

  ```
  Sass是一种非常容易上手的CSS预处理框架，能够更好地维护CSS代码。
  ```

- bower

  ```
  bower作为一种包管理器，提供了各种库和框架的接口，极大了遍历第三方代码的管理。
  我所用的的第三方库和框架基本在这一节(主要技术)列出，详见根目录下bower.json文件
  ```

- Grunt

  ```
  Grunt作为一种优秀的前端自动化构建工具，提供了各种各样的插件，比如jshint(代码检查)，concat(代码拼接)，sass(Sass代码自动编译等)。
  我所用到的插件及其配置信息，详见根目录下Gruntfile.js文件
  ```

- git

  ```
  git这个不用多说，作为一个优秀的版本控制工具，即使这个项目是由我单独开发，这个工具极大地帮助我控制项目流程。
  ```

- php

  ```
  非常容易上手，前端工程师写后端必备
  ```

- python3

  ```
  python其实有丰富的第三方库可以使用，且此语言用途广泛。虽然它更多地因为爬虫为人所知。我用它写爬虫。
  ```

- pyspider

  ```
  pyspider是一种非常好用爬虫框架。有以下优点：可以使用python的pyquery模块(作为一个熟悉jQuery的前端开发者，我非常喜欢这个模块，因为它与jQuery非常类似);集成了phantomjs;提供了调度器，减少了在服务器上配置工作。
  ```


#### 2.2 部署方案

- 阿里云服务器

| CPU： 1核                                  |
| ---------------------------------------- |
| 内存： 1 GB                                 |
| 实例类型： I/O优化                              |
| 操作系统： Ubuntu 14.04 64位                   |
| 公网IP： 120.77.34.254                      |
| 私有IP： 172.18.34.7                        |
| 带宽计费方式： 按使用流量                            |
| 当前使用带宽： 15Mbps（峰值）                       |
| 专有网络： [vpc-wz9gsea0pxaxcjznq4wgd](http://home.console.aliyun.com/redirect.htm?productId=vpc&path=region/cn-shenzhen/vpc/vpc-wz9gsea0pxaxcjznq4wgd&regionId=cn-shenzhen) |

- PHP Version 5.6.10


- mysql  Ver 14.14 Distrib 5.6.33
- Server version: Apache/2.4.7 (Ubuntu)
- Python 3.4.3
- pyspider

## 3 功能点及界面

#### 3.1 导航栏

- 采用了bootswatch提供的组件样式,如下图

![0F5E6DFA-3B03-4CB6-97B8-BB08802369F0](/Users/achao_zju/Library/Containers/com.tencent.qq/Data/Library/Application Support/QQ/Users/986934360/QQ/Temp.db/0F5E6DFA-3B03-4CB6-97B8-BB08802369F0.png)

```
可以很方便地跳转到了首页和各类新闻，也集成了注册和登录和登出功能，这些会在之后细讲
```
#### 3.2 首页

- 首页的组件是bootswatch的panel样式，如下图

![屏幕快照 2017-06-10 上午10.48.46](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午10.48.46.png)

```
我们可以看到，首页中内有全站十大(也就是所有最热门新闻，每类新闻取最热门的两个,热门程序根据点击量判定)。
还有五类新闻的各自热门。
新闻标题右边的数字是点击量，新闻标题也是到详情页面的链接，详情页面时我自己开发的。
```
#### 3.3 分类新闻列表页面(以军事新闻为例)

- 此页面的UI样式也是bootswatch的panle样式

![屏幕快照 2017-06-10 上午10.55.31](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午10.55.31.png)



- 提供标题和来源的关键字检索功能，此处用到了angular.js的过滤器，如下图

![780E395A-36ED-4CCE-8AA0-E322BA86C61B](/Users/achao_zju/Library/Containers/com.tencent.qq/Data/Library/Application Support/QQ/Users/986934360/QQ/Temp.db/780E395A-36ED-4CCE-8AA0-E322BA86C61B.png)



- 支持按时间排序和热门程序排序，如下图,默认按时间排序

![屏幕快照 2017-06-10 上午10.59.34](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午10.59.34.png)

- 为减轻服务器的压力，一次最多获取10条新闻，如要获取更多，需要点击“显示更多新闻”

  ![屏幕快照 2017-06-10 上午11.02.17](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.02.17.png)

- 点击可以获取详情页面，不再赘述

#### 3.4  注册、登录和登出

- 注册和登录采用bootswatch的模态框组件,如下图

  ![屏幕快照 2017-06-10 上午11.09.55](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.09.55.png)

  ![屏幕快照 2017-06-10 上午11.10.10](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.10.10.png)



```
注册支持合法性校验，登录功能支持session
```

- 登录后即可使用登出功能

  ![屏幕快照 2017-06-10 上午11.12.50](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.12.50.png)

#### 3.5 新闻偏好页面

```
登录后还可以设置新闻偏好，分类新闻是否出现由当前用户的偏好决定
```

![屏幕快照 2017-06-10 上午11.17.18](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.17.18.png)

#### 3.6 新闻详情页面

```
从下图可以看到新闻的内容都被格式了。我爬取的是央视网和搜狐新闻，无论原来是什么样式，都被统一为相同的样式
```

![屏幕快照 2017-06-10 上午11.14.50](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.14.50.png)

#### 3.7 爬虫模块

```
爬虫模块是用pyspider框架，这个框架提供了完善的调度和调试功能
```

![屏幕快照 2017-06-10 上午11.24.23](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.24.23.png)

![屏幕快照 2017-06-10 上午11.25.53](/Users/achao_zju/Desktop/屏幕快照 2017-06-10 上午11.25.53.png)

